<!-- <head> ... 생략 가능 -->
<body>
  <div class="neon-title">다면체와 회전체</div>
  <p class="description">
    이 인공지능은 <strong>다면체</strong>와 <strong>회전체</strong>를 식별합니다.<br>
    <strong>Start</strong> 버튼을 눌러 웹캠을 실행하고, 주변의 사물이나 교재의 도형을 보여주세요!
  </p>
  <button onclick="init()">Start</button>

  <div id="webcam-container"></div>
  <div id="label-container"></div>
  <div id="result"></div>

  <script>
    const URL = "https://teachablemachine.withgoogle.com/models/AwkAbaC-0/";

    let model, webcam, labelContainer, maxPredictions;

    async function init() {
      const modelURL = URL + "model.json";
      const metadataURL = URL + "metadata.json";

      model = await tmImage.load(modelURL, metadataURL);
      maxPredictions = model.getTotalClasses();

      webcam = new tmImage.Webcam(200, 200, true);
      await webcam.setup();
      await webcam.play();
      window.requestAnimationFrame(loop);

      const container = document.getElementById("webcam-container");
      container.innerHTML = "";
      container.appendChild(webcam.canvas);

      labelContainer = document.getElementById("label-container");
      for (let i = 0; i < maxPredictions; i++) {
        labelContainer.appendChild(document.createElement("div"));
      }
    }

    async function loop() {
      webcam.update();
      await predict();
      window.requestAnimationFrame(loop);
    }

    async function predict() {
      const prediction = await model.predict(webcam.canvas);
      let resultText = "";

      for (let i = 0; i < maxPredictions; i++) {
        const className = prediction[i].className;
        const probability = prediction[i].probability;
        const text = `${className}: ${probability.toFixed(2)}`;
        labelContainer.childNodes[i].innerHTML = text;

        if (className.includes("다면체") && probability > 0.5) {
          resultText = "다면체";
        } else if (className.includes("회전체") && probability > 0.5) {
          resultText = "회전체";
        }
      }

      document.getElementById("result").innerText = resultText;
      console.log(prediction.map(p => `${p.className}: ${p.probability.toFixed(2)}`));
    }
  </script>
</body>
